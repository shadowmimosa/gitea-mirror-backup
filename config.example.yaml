# ============================================================
# Gitea é•œåƒå¤‡ä»½ç³»ç»Ÿé…ç½®æ–‡ä»¶ - ç›´æ¥éƒ¨ç½²ç‰ˆæœ¬
# ============================================================
# 
# ğŸ“– ä½¿ç”¨è¯´æ˜ï¼š
#   æ­¤é…ç½®ç”¨äºç›´æ¥åœ¨å®¿ä¸»æœºè¿è¡Œï¼ˆé Dockerï¼‰
#   è·¯å¾„ä½¿ç”¨å®¿ä¸»æœºè·¯å¾„
#   
#   Docker éƒ¨ç½²è¯·ä½¿ç”¨ config.docker.yaml
#
# ğŸ“š ä½¿ç”¨æ–¹æ³•ï¼š
#   cp config.example.yaml config.yaml
#   vim config.yaml  # ä¿®æ”¹è·¯å¾„å’Œé…ç½®
#
# ============================================================

# Gitea Docker é…ç½®
gitea:
  # Docker å®¹å™¨åç§°
  docker_container: "gitea"
  
  # Docker å®¹å™¨å†…çš„ Git ç”¨æˆ·ï¼ˆé€šå¸¸æ˜¯ 'git'ï¼‰
  docker_git_user: "git"
  
  # Gitea æ•°æ®å·è·¯å¾„ï¼ˆå®¿ä¸»æœºè·¯å¾„ï¼‰
  data_volume: "/opt/gitea"
  
  # Gitea ä»“åº“åœ¨å·ä¸­çš„ç›¸å¯¹è·¯å¾„
  repos_path: "git/repositories"

# å¤‡ä»½é…ç½®
backup:
  # å¤‡ä»½æ ¹ç›®å½•ï¼ˆå®¿ä¸»æœºè·¯å¾„ï¼‰
  root: "/opt/backup/gitea-mirrors"
  
  # åªå¤‡ä»½ç‰¹å®šç»„ç»‡çš„ä»“åº“ï¼ˆç•™ç©ºæˆ–ç©ºæ•°ç»„åˆ™å¤‡ä»½æ‰€æœ‰ï¼‰
  organizations: []
  # organizations: ["Org1", "Org2"]  # ç¤ºä¾‹ï¼šåªå¤‡ä»½è¿™äº›ç»„ç»‡
  
  # æ˜¯å¦æ£€æŸ¥é•œåƒä»“åº“ï¼ˆå¦‚æœä¸º falseï¼Œå¤‡ä»½æ‰€æœ‰ä»“åº“ï¼‰
  check_mirror_only: false
  
  # ä¿ç•™ç­–ç•¥
  retention:
    # å¿«ç…§ä¿ç•™å¤©æ•°
    snapshots_days: 30
    
    # æ¯æœˆå½’æ¡£ä¿ç•™æœˆæ•°
    archives_months: 12
    
    # æŠ¥å‘Šä¿ç•™å¤©æ•°
    reports_days: 30

# å¼‚å¸¸æ£€æµ‹é…ç½®
alerts:
  # æäº¤æ•°å¼‚å¸¸é˜ˆå€¼ï¼ˆå‡å°‘ç™¾åˆ†æ¯”ï¼‰
  commit_decrease_threshold: 10
  
  # ä»“åº“å¤§å°å¼‚å¸¸é˜ˆå€¼ï¼ˆå‡å°‘ç™¾åˆ†æ¯”ï¼‰- ä»…ä½œä¸ºè¾…åŠ©å‚è€ƒ
  size_decrease_threshold: 30
  
  # å¼‚å¸¸å¿«ç…§æ°¸ä¹…ä¿ç•™ï¼ˆæ£€æµ‹åˆ°å¼‚å¸¸æ—¶è‡ªåŠ¨æ ‡è®°ï¼‰
  protect_abnormal_snapshots: true

# æ—¥å¿—é…ç½®
logging:
  # æ—¥å¿—æ–‡ä»¶è·¯å¾„
  file: "/var/log/gitea-mirror-backup.log"
  
  # æ—¥å¿—çº§åˆ«: DEBUG, INFO, WARNING, ERROR, CRITICAL
  level: "INFO"
  
  # æ—¥å¿—æ ¼å¼
  format: "[%(asctime)s] %(levelname)s: %(message)s"
  
  # æ—¥æœŸæ ¼å¼
  date_format: "%Y-%m-%d %H:%M:%S"

# æŠ¥å‘Šé…ç½®
reports:
  # æŠ¥å‘Šç›®å½•ï¼ˆç›¸å¯¹äº backup.rootï¼‰
  directory: "reports"
  
  # æœ€æ–°æŠ¥å‘Šé“¾æ¥åç§°
  latest_link: "latest-report.md"

# é€šçŸ¥é…ç½®
notifications:
  # é‚®ä»¶é€šçŸ¥
  email:
    enabled: false
    smtp_host: "smtp.example.com"
    smtp_port: 587
    smtp_user: "user@example.com"
    smtp_password: "password"
    from_addr: "backup@example.com"
    to_addrs:
      - "admin@example.com"
    # é€šçŸ¥æ¡ä»¶ï¼šalways(æ€»æ˜¯), on_error(ä»…é”™è¯¯), on_alert(ä»…å¼‚å¸¸)
    notify_on: "on_alert"
    
  # Webhook é€šçŸ¥
  webhook:
    enabled: false
    url: "https://example.com/webhook"
    method: "POST"
    headers:
      Content-Type: "application/json"
    notify_on: "on_alert"
  
  # ä¼ä¸šå¾®ä¿¡æœºå™¨äºº
  wecom:
    enabled: false
    webhook_url: "https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=xxx"
    notify_on: "on_alert"
  
  # é’‰é’‰æœºå™¨äºº
  dingtalk:
    enabled: false
    webhook_url: "https://oapi.dingtalk.com/robot/send?access_token=xxx"
    secret: ""  # å¯é€‰ï¼ŒåŠ ç­¾å¯†é’¥
    notify_on: "on_alert"

# é«˜çº§é…ç½®
advanced:
  # å¹¶å‘å¤‡ä»½æ•°é‡ï¼ˆ0 è¡¨ç¤ºä¸²è¡Œï¼‰
  concurrent_backups: 0
  
  # å¤‡ä»½è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼Œ0 è¡¨ç¤ºæ— é™åˆ¶ï¼‰
  backup_timeout: 0
  
  # æ˜¯å¦åœ¨å¤‡ä»½å‰éªŒè¯ Docker å®¹å™¨
  verify_docker: true
  
  # æ˜¯å¦ç”Ÿæˆæ¢å¤è„šæœ¬
  generate_restore_script: true

